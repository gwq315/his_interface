# 使用指南

## 一、系统概述

本系统用于管理医院HIS系统的接口文档，支持视图接口和API接口的统一管理。

## 二、核心功能

### 1. 接口管理

#### 添加接口
1. 点击左侧菜单"新增接口"
2. 填写接口基本信息：
   - **接口编码**：唯一标识，如 `PATIENT_QUERY`
   - **接口名称**：接口的中文名称
   - **接口类型**：选择"视图接口"或"API接口"
   - **HTTP方法**：仅API接口需要，选择GET/POST/PUT/DELETE
   - **接口URL**：接口的访问地址
   - **分类**：接口所属分类，如"患者管理"、"医嘱管理"等
   - **标签**：多个标签用逗号分隔，如"患者,查询,常用"
   - **状态**：启用或禁用
   - **描述**：接口的详细说明

#### 管理参数
在接口表单中，有两个标签页：
- **入参**：接口的输入参数
- **出参**：接口的返回参数

每个参数包含：
- **字段名**：参数在接口中的字段名
- **参数名称**：参数的中文名称
- **数据类型**：string/int/float/boolean/object/array
- **必填**：是否必填（仅入参）
- **默认值**：默认值（仅入参）
- **描述**：参数说明
- **示例**：示例值

### 2. 查询接口

#### 关键词搜索
在搜索栏输入关键词，系统会搜索：
- 接口名称
- 接口编码
- 接口描述

#### 筛选条件
- **接口类型**：视图接口 / API接口
- **分类**：按分类筛选
- **标签**：按标签筛选（待完善）

#### 查看详情
点击接口列表中的"查看"按钮，可以查看：
- 接口完整信息
- 入参列表
- 出参列表
- 关联字典

### 3. 字典管理

字典用于定义参数的取值范围，如：
- 性别字典：{1: "男", 2: "女"}
- 状态字典：{0: "禁用", 1: "启用"}

#### 创建字典
1. 进入"字典管理"页面
2. 点击"新增字典"
3. 填写字典信息：
   - **字典编码**：唯一标识
   - **字典名称**：字典的中文名称
   - **描述**：字典说明
4. 添加字典值（键值对）

#### 关联字典
在参数管理中，可以为参数关联字典，这样在查看参数时可以看到字典值。

### 4. 数据导出

#### 导出JSON
访问：`http://localhost:8000/api/import-export/export/json`

导出的JSON文件包含：
- 所有接口信息
- 所有参数信息
- 所有字典信息

#### 导出Excel
访问：`http://localhost:8000/api/import-export/export/excel`

导出的Excel文件包含多个工作表：
- 接口列表
- 参数列表
- 字典列表
- 字典值

## 三、使用场景

### 场景1：添加新的API接口

假设要添加一个"患者信息查询"接口：

1. **基本信息**
   - 编码：`PATIENT_QUERY`
   - 名称：`患者信息查询接口`
   - 类型：`API接口`
   - 方法：`POST`
   - URL：`/api/patient/query`
   - 分类：`患者管理`

2. **入参**
   ```
   字段名：patient_id
   类型：string
   必填：是
   描述：患者ID
   ```

3. **出参**
   ```
   字段名：patient_info
   类型：object
   描述：患者信息
   ```

### 场景2：添加视图接口

视图接口不需要HTTP方法，URL可以是视图名称：

1. **基本信息**
   - 编码：`VIEW_PATIENT_LIST`
   - 名称：`患者列表视图`
   - 类型：`视图接口`
   - URL：`v_patient_list`
   - 分类：`患者管理`

2. **参数管理**
   - 视图接口的入参和出参根据视图字段定义

### 场景3：快速查找接口

当需要查询某个接口时：

1. 在搜索栏输入关键词，如"患者"
2. 系统会显示所有包含"患者"的接口
3. 可以进一步按分类筛选
4. 点击接口查看详细信息

## 四、最佳实践

### 1. 接口编码规范
- 使用大写字母和下划线
- 使用有意义的名称
- 保持唯一性
- 示例：`PATIENT_QUERY`, `ORDER_CREATE`, `VIEW_PATIENT_LIST`

### 2. 分类管理
建议使用统一的分类体系：
- 患者管理
- 医嘱管理
- 药品管理
- 收费管理
- 检验检查
- 等等

### 3. 标签使用
使用标签标记接口特性：
- 常用接口：`常用`
- 重要接口：`重要`
- 待测试：`待测试`
- 已废弃：`已废弃`

### 4. 参数描述
- 清晰描述参数用途
- 提供示例值
- 标注必填项
- 说明数据格式

## 五、常见问题

### Q1: 如何批量导入接口？
A: 目前支持JSON和Excel导出，导入功能待完善。可以先导出模板，填写后手动导入。

### Q2: 接口可以关联多个字典吗？
A: 每个参数可以关联一个字典。如果参数需要多个字典，可以创建复合字典。

### Q3: 如何删除接口？
A: 在接口列表中点击"删除"按钮，确认后删除。注意：删除接口会同时删除所有关联的参数。

### Q4: 如何备份数据？
A: 定期导出JSON或Excel文件作为备份。也可以直接复制数据库文件 `his_interfaces.db`。

### Q5: 支持接口版本管理吗？
A: 当前版本不支持，可以在接口编码中包含版本号，如 `PATIENT_QUERY_V2`。

## 六、技术支持

如有问题，请查看：
- API文档：http://localhost:8000/docs
- 设计文档：`DESIGN.md`
- 项目README：`README.md`

